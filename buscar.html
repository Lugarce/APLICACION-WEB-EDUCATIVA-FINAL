<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Matienzo - Buscar temas</title>
  <link rel="stylesheet" href="styles.css" />
</head>

<body>

  <div class="layout">

    <!-- SIDEBAR UNIFICADO -->
    <aside class="sidebar">

      <div class="sidebar-header">
        <img src="logo.png" alt="Logo Matienzo" class="sidebar-logo">
        <div class="sidebar-title">Matienzo</div>
      </div>

      <nav class="nav-menu">
        <a href="index.html" class="nav-item">
          <svg viewBox="0 0 24 24" stroke="currentColor" fill="none">
            <path d="M3 12l9-9 9 9"/>
            <path d="M9 21V9h6v12"/>
          </svg>
          <span>Inicio</span>
        </a>

        <a href="buscar.html" class="nav-item active">
          <svg viewBox="0 0 24 24" stroke="currentColor" fill="none">
            <circle cx="11" cy="11" r="7"/>
            <line x1="16.65" y1="16.65" x2="21" y2="21"/>
          </svg>
          <span>Buscar</span>
        </a>

        <a href="temas.html" class="nav-item">
          <svg viewBox="0 0 24 24" stroke="currentColor" fill="none">
            <rect x="3" y="4" width="18" height="6" rx="2"/>
            <rect x="3" y="14" width="18" height="6" rx="2"/>
          </svg>
          <span>Temas</span>
        </a>

        <a href="recursos.html" class="nav-item">
          <svg viewBox="0 0 24 24" stroke="currentColor" fill="none">
            <path d="M4 4h16v16H4z"/>
            <path d="M4 15l5-5 4 4 3-3 4 4"/>
          </svg>
          <span>Recursos</span>
        </a>

        <a href="autor.html" class="nav-item">
          <svg viewBox="0 0 24 24" stroke="currentColor" fill="none">
            <circle cx="12" cy="7" r="4"/>
            <path d="M4 21c2-4 6-6 8-6s6 2 8 6"/>
          </svg>
          <span>Autor</span>
        </a>
      </nav>

      <!-- CONFIGURACIÓN UNIFICADA AL FINAL -->
      <div class="configuracion">
        <div class="configuracion-box" id="modo-oscuro-box">
          <span>Modo Oscuro</span>
          <div class="toggle-btn" id="toggle-theme"></div>
        </div>
        <div class="configuracion-box" id="reset-datos">
          <span>Reset Datos</span>
        </div>
      </div>

    </aside>

    <!-- CONTENIDO -->
    <main class="main">

      <h1>Buscar temas</h1>
      <p style="color:var(--clr-text-muted); margin-bottom:16px;">
        Encuentra cualquier tema según su nombre, grado o curso.
      </p>

      <!-- BUSCADOR -->
      <div class="card" style="margin-bottom:20px;">
        <input id="buscarInput" placeholder="Escribe un tema (Ejemplo: Triángulos)"
          style="
            width:100%;
            padding:14px 16px;
            border-radius:var(--radius);
            border:none;
            background:var(--clr-bg-soft-2);
            font-size:1rem;
          ">
      </div>

      <!-- FILTROS -->
      <div class="card" style="margin-bottom:22px;">
        <h2>Filtros</h2>

        <div style="display:flex; gap:20px; margin-top:12px; flex-wrap:wrap;">
          <!-- AÑO -->
          <div>
            <label>Año</label>
            <select id="filtroAnio" style="
              padding:10px; border-radius:var(--radius);
              background:var(--clr-bg-soft-2); border:none;">
              <option value="">Todos</option>
              <option value="1">1°</option>
              <option value="2">2°</option>
              <option value="3">3°</option>
              <option value="4">4°</option>
              <option value="5">5°</option>
            </select>
          </div>

          <!-- CURSO -->
          <div>
            <label>Curso</label>
            <select id="filtroCurso" style="
              padding:10px;
              border-radius:var(--radius);
              background:var(--clr-bg-soft-2); border:none;">
              <option value="">Todos</option>
              <option>Álgebra</option>
              <option>Aritmética</option>
              <option>Geometría</option>
              <option>Trigonometría</option>
            </select>
          </div>
        </div>
      </div>

      <!-- RESULTADOS -->
      <div id="resultados" class="dashboard-grid"></div>

    </main>

  </div>

  <script src="app.js"></script>

  <script>
    // Si quieres mantener el script original pero ahora usando data real
    (async function() {
      const resultados = document.getElementById("resultados");
      const input = document.getElementById("buscarInput");
      const filtroAnio = document.getElementById("filtroAnio");
      const filtroCurso = document.getElementById("filtroCurso");

      let temas = [];
      try {
        const r = await fetch("temas.json");
        const data = await r.json();
        temas = data.temas || [];
      } catch (e) {
        console.warn("No se pudo cargar temas.json", e);
      }

      function render(lista) {
        resultados.innerHTML = "";
        lista.forEach(t => {
          const a = document.createElement("a");
          a.className = "topic-card";
          a.href = `ver-tema.html?id=${encodeURIComponent(t.id)}`;
          a.textContent = `${t.curso} — ${t.titulo}`;
          a.style.display = "block";
          a.style.marginTop = "12px";
          resultados.appendChild(a);
        });
        if (lista.length === 0) {
          resultados.innerHTML = "<div class='card'><h2>No se encontraron temas.</h2></div>";
        }
      }

      render(temas);

      input.addEventListener("input", () => {
        const q = input.value.toLowerCase();
        let filtrado = temas.filter(t => 
          t.titulo.toLowerCase().includes(q) || t.curso.toLowerCase().includes(q)
        );
        if (filtroAnio && filtroAnio.value) filtrado = filtrado.filter(t => String(t.anio) === String(filtroAnio.value));
        if (filtroCurso && filtroCurso.value) filtrado = filtrado.filter(t => t.curso === filtroCurso.value);
        render(filtrado);
      });

      filtroAnio.addEventListener("change", () => input.dispatchEvent(new Event('input')));
      filtroCurso.addEventListener("change", () => input.dispatchEvent(new Event('input')));
    })();
  </script>

</body>
</html>